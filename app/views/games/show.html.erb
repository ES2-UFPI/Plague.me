<p style="color: green"><%= notice %></p>

<%= render @game %>

<h2>Reviews:</h2>

<% @game.reviews.each do |review| %>
  <p><%= link_to "#{review.user.nickname}:", user_path(review.user) %></p>
  <p><%= review.content %> - Nota: <%= review.score %> - Postado em <%= review.posted_at.strftime('%d/%m/%Y %H:%M:%S') %>
  <% if review.user == current_user %>
  <%= button_to 'Excluir', review_path(review), method: :delete %></p>
<% end %>
<% end %>

<h2>Deixe sua review:</h2>

<form action="<%= reviews_path(@game) %>" method="post">
  <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
  <input type="hidden" name="game_id" value="<%= @game.id %>">
  <textarea name="review[content]"></textarea>
  <label for="score">Nota:</label>
  <input type="number" name="review[score]" min="0" max="10" step="0.1">
  <input type="submit" value="Postar review">
</form>

<div>

<br>

<% if user_signed_in? %>
  <% if current_user.favorite_games.include?(@game) %>
    <%= button_to 'Remover dos favoritos', favorite_game_path(@game), method: :post, class: 'btn btn-outline-danger' %>
  <% else %>
    <%= button_to 'Adicionar aos favoritos', favorite_game_path(@game), method: :post, class: 'btn btn-outline-success' %>
  <% end %>
<% end %>

  <br>

  <%= form_tag(add_to_collection_game_path(@game), method: :post) do %>
    <%= collection_select :collection_item, :collection_id, current_user.collections, :id, :title, { prompt: 'Selecione uma coleção' } %>
    <%= submit_tag 'Adicionar à coleção' %>
  <% end %>

  <%= link_to "Edit this game", edit_game_path(@game) %> |
  <%= link_to "Back to games", games_path %>

  <%= button_to "Destroy this game", @game, method: :delete %>
</div>
